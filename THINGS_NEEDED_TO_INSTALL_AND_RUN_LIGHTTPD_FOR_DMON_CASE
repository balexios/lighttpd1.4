============
Installation
============

:author: Alexios Voulimeneas
:Date: 23 April 2018

Installation
------------

  $ cd lighttpd-1.x.x
  $ ./autogen.sh
  $ ./configure --prefix=$HOME/test_lighttpd
  $ make
  $ su -
  # make install
  # exit

static build using make
-----------------------

* edit src/Makefile.am and, in the section under 'if LIGHTTPD_STATIC',
  update lighttpd_SOURCES with each module to be included in the static build

I removed these stuff and made an empty plugin-static.h

#\
#  mod_access.c \
#  mod_accesslog.c \
#  mod_alias.c \
#  mod_auth.c \
#  mod_authn_file.c \
#  mod_cgi.c \
#  mod_compress.c \
#  mod_deflate.c \
#  mod_dirlisting.c \
#  mod_evasive.c \
#  mod_expire.c \
#  mod_extforward.c \
#  mod_fastcgi.c \
#  mod_flv_streaming.c \
#  mod_indexfile.c \
#  mod_proxy.c \
#  mod_redirect.c \
#  mod_rewrite.c \
#  mod_rrdtool.c \
#  mod_scgi.c \
#  mod_secdownload.c \
#  mod_setenv.c \
#  mod_simple_vhost.c \

//  i removed them in order for lighttpd to statically compile
#  mod_ssi_exprparser.c mod_ssi_expr.c mod_ssi.c \

#  mod_staticfile.c \
#  mod_status.c \
#  mod_uploadprogress.c \
#  mod_userdir.c \
#  mod_usertrack.c \
#  mod_vhostdb.c \
#  mod_webdav.c

* create src/plugin-static.h with list of modules as PLUGIN_INIT(mod_foo)
  for each module 'mod_foo' to be included in the static build

  $ LIGHTTPD_STATIC=yes ./configure -C --enable-static=yes --prefix=$HOME/test_lighttpd
  $ make
  $ su
  $ make install

static build with musl-c
-----------------------
  $ cd lighttpd-1.x.x
  $ ./autogen.sh
  $ CC=/home/dreamer/DMon/deps/musl-install/bin/musl-gcc LIGHTTPD_STATIC=yes ./configure -C --enable-static=yes --prefix=/home/dreamer/test_lighttpd --without-zlib --without-bzip2 --without-pcre --enable-static LDFLAGS=--static --disable-shared
  $ make
  $ su
  # make install
  # exit

Check with readelf -d path_to/lighttpd if there is a shared library

RUN
------------

  $su -
  # cd /home/dreamer/test_lighttpd/sbin
  # ./lighttpd -D -f ../../lighttpd1.4/doc/config/basic_lighttpd.conf
    For my MVEE the following is better
    strace /home/dreamer/test_lighttpd/sbin/lighttpd -D -f /home/dreamer/DMon/Tests/Webservers/lighttpd1.4_testing/docroot/basic_lighttpd.conf

/home/dreamer/lighttpd1.4/src/server.c I needed to comment HAVE_VERSIONSTAMP_H in order for the write to fail at check buffer
This is a small limitation however we can permit these kind of known false positives in DMON either with DCL or with known false positives
